<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Witchcraft: Frequently asked questions</title>

    <link rel="stylesheet" href="index.css">

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-101273659-1', 'auto');
        ga('send', 'pageview');
    </script>
</head>
<body>

<div class="container">
    <div class="header">
        <img class="title" src="../docs/src/assets/title.png" alt="Witchcraft">
        <img class="witch" src="../docs/src/assets/witch.svg" alt="">
    </div>

    <p class="menu">
        <a href="index.html">Home</a>
        -
        <a href="how-to-install.html">How to install</a>
    </p>

    <article>
        <h2>Frequently Asked Questions</h2>

        <p class="question">Q: Where should I put my Witchcraft scripts?</p>
        <p class="answer">A: You must put them in the same folder being served by your local web server. Read full instructions <a
                href="how-to-install.html" target="_blank">here</a>.</p>

        <p class="question">Q: How to add third-party libraries to my scripts?</p>
        <p class="answer">A: Use the <span class="code">@include</span> directive as described in "Including other scripts" <a href="index.html#include-directive">here</a>. You can either download the library and include it locally or reference it via a CDN URL. Example:</p>

        <p><span class="code">// @include https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.13/dayjs.min.js</span></p>

        <p class="question">Q: Why do I need a local web server?</p>
        <p class="answer">A: By default, Witchcraft will look for scripts in:</p>

        <p><span class="code">http://127.0.0.1:5743</span></p>

        <p>For example:</p>

        <p><span class="code">http://127.0.0.1:5743/github.com.js</span></p>

        <p>Chrome extensions do not have the permission to access files in disk, so one way around it is to expose your scripts folder via a local HTTP server - and that's the strategy Witchcraft uses. For a comprehensive list of local server options, check this <a href="//gist.github.com/willurd/5720255" target="_blank">gist</a>.</p>

        <p class="question">Q: Couldn't Witchcraft spawn its own local web server?</p>
        <p class="answer">A: Unfortunately, no. See question above.</p>

        <p class="question">Q: When exactly my script gets loaded?</p>
        <p class="answer">As of v3.0, it is loaded when the <a href="https://developer.chrome.com/docs/extensions/reference/api/webNavigation#event-onCommitted">chrome.webNavigation.onCommitted</a> event is fired. The method
            <a href="https://developer.chrome.com/docs/extensions/reference/api/scripting#method-executeScript">chrome.scripting.executeScript</a> is then called to inject the JavaScript file into the current page with the option <span class="code">injectImmediately</span> set to <span class="code">true</span>. This means that the script is expected to be injected in the page before the
            <a href="https://developer.mozilla.org/en-US/docs/Web/Events/DOMContentLoaded"><span class="code">DOMContentLoaded</span></a> event is fired.</p>

        <p class="question">Q: My script seems to be loading multiple times. What is wrong?</p>
        <p class="answer">A: Your page probably has frames/iframes in it. By design, Witchcraft loads itself into every window it can find. If you want to run your script in a specific frame, you need to enforce that inside your script. For instance, you may want your script to run only in the top frame. In that case, just check if <span class="code">window.self === window.top</span>. More details
            <a href="https://github.com/luciopaiva/witchcraft/issues/23">here</a>.</p>

        <p class="question">Q: How to load Witchcraft only in the topmost window?</p>
        <p class="answer">A: Check the question above.</p>

        <p class="question"><del>Q: I'm unable to read custom properties from or change the window object in any way. What is wrong?</del></p>
        <p class="answer"><del>A: Scripts can't directly access the window object. They share the DOM tree, but they live in
            <a href="https://www.youtube.com/watch?v=laLudeUmXHM">isolated worlds</a>. This is a restriction imposed by the Chrome extension API. You can, however,
            <a href="https://stackoverflow.com/q/12395722/778272" target="_blank">work around it</a> easily.</del></p>

        <p>Starting with Witchcraft v3.0, that is no longer an issue. Scripts now have direct access to the page's world, meaning they share the same <span class="code">window</span> object as the page.</p>

        <p class="question">Q: How do I inject scripts into localhost web servers?</p>
        <p class="answer">A: In case you are developing a web page and testing it using a local web server, you can inject code in it by naming your script <span class="code">localhost.js</span>/<span class="code">localhost.css</span>. If you're running multiple web servers on different ports and need to tell them apart, do it by checking the port inside your script (check the <span class="code">location.port</span> property). See an example
            <a href="https://github.com/luciopaiva/witchcraft/issues/18">here</a>.</p>

        <p class="question">Q: Can I install Witchcraft from sources instead?</p>
        <p class="answer">A: Yes, you can install Witchcraft directly from sources instead of downloading it from the Chrome store. Look for the extension source under the folder `/chrome-extension` and manually load it as an unpacked extension. If you don't know how to load unpacked extensions in Chrome, just google it; it should be very straightforward.</p>

        <p class="question">Q: Is Google Analytics being used? Why?</p>
        <p class="answer">A: Yes. It is being used to track actions performed inside the Witchcraft pop-up window (.e.g: "user clicked the report issue button") and to collect anonymous statistics (e.g.: how many times was a JS include directive triggered) in order to help improve the extension. Code is carefully tailored to make sure no user-identifiable information is sent to GA. For instance, URLs being accessed and script names are not sent to GA in any way. People are encouraged to verify the code themselves and also load the extension right from the sources if they don't trust the Chrome Web Store package.</p>

        <p class="question">Q: How can I load other resources in my scripts, like images?</p>
        <p class="answer">A: There are three proposed ways to do it <a
                href="https://github.com/luciopaiva/witchcraft/issues/34#issuecomment-782858968">here</a>.</p>

        <p class="question">Q: Why is my script not updating?</p>
        <p class="answer">A: Refreshing the page should be enough to update the script. If that's not the case, check if your HTTP server might be caching it on the server side. Try running <span class="code">python3 -m http.server 5743</span> instead to see if it solves the problem.</p>
    </article>

    <hr>

    <p class="footnote right">Made by <a href="//luciopaiva.com" target="_blank">Lucio Paiva</a> - July 2025</p>
    <p class="footnote left">View <a href="//github.com/luciopaiva/witchcraft" target="_blank">source</a> on GitHub</p>
</div>

<!-- github corner - https://github.com/tholman/github-corners -->
<a href="//github.com/luciopaiva/witchcraft" target="_blank" class="github-corner" aria-label="View source on Github">
    <svg width="80" height="80" viewBox="0 0 250 250" style="fill:var(--secondary-color-darker); color:var(--background-color); position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<!-- github corner -->

</body>
</html>
